{
    "collab_server" : "",
    "contents" : "# prepare the data\nlibrary(fpp)\nlibrary(dplyr)\nPG <- read.csv(\"IPG2211N.csv\") %>%\n  select(-DATE) %>%\n  ts(start=c(1972,1), frequency=12)\nPG1.tr <- window(PG, end=c(1995,12))\nPG1.te <- window(PG, start=c(1996,1), end=c(2000,12))\n\n# Question 1\nL <- BoxCox.lambda(PG1.tr)\nL\nz <- BoxCox(PG1.tr, L)        # Box-Cox series \ntsdisplay(diff(z))            # non-seasonal diff\ntsdisplay(diff(z, lag = 12))  # seasonal diff\nadf.test(z)\n\n# Question 2\nmodel2 <- auto.arima(PG1.tr, lambda = L)\nsummary(model2)\ntsdiag(model2, gof.lag = 24)\nforecast2 <- forecast(model2, h = 60)\nplot(forecast2, xlim = c(1990,2001), ylim = c(60,140))\nlines(PG1.te, col = \"red\")\naccuracy(forecast2, PG1.te)\n\n# Question 3 - manual model selection\nmodel3a <- Arima(PG1.tr, order=c(1,1,2), seasonal=c(1,1,1), lambda = L)\nsummary(model3a)\n          # didn't help\nmodel3b <- Arima(PG1.tr, order=c(1,1,1), seasonal=c(0,1,1), lambda = L)\nsummary(model3b)\n          # didn't help\nmodel3c <- Arima(PG1.tr, order=c(1,1,2), seasonal=c(0,1,2), lambda = L)\nsummary(model3c)\n          # didn't help\nmodel3d <- Arima(PG1.tr, order=c(1,1,0), seasonal=c(0,1,1), lambda = L)\nsummary(model3d)\n          # didn't help\nmodel3e <- Arima(PG1.tr, order=c(1,0,2), seasonal=c(0,1,1), lambda = L)\nsummary(model3e)\ntsdiag(model3e, gof.lag = 24)\nforecast3e <- forecast(model3e, h = 60)\nplot(forecast3e, xlim = c(1990,2001), ylim = c(60,140))\nlines(PG1.te, col = \"red\")\naccuracy(forecast3e, PG1.te)\n          # helped!!!\n\n# Question 4\nPG2.tr <- window(PG, end=c(2011,12))\nPG2.te <- window(PG, start=c(2012,1))\nL2 <- BoxCox.lambda(PG2.tr)\nL2\nz <- BoxCox(PG2.tr, L2)\ntsdisplay(diff(z))\ntsdisplay(diff(z, lag = 12))\nadf.test(z)\n\n# Question 5\nmodel5 <- auto.arima(PG2.tr, lambda = L2)\nsummary(model5)\ntsdiag(model5, gof.lag = 24)\nforecast5 <- forecast(model5, h = 69)\nplot(forecast5, xlim = c(2000,2018), ylim = c(60,140))\nlines(PG2.te, col = \"red\")\naccuracy(forecast5, PG2.te)\n\n# Question 6\nPG3.tr <- window(PG, start=c(2005,1), end=c(2011,12))\nL3 <- BoxCox.lambda(PG3.tr)\nmodel6 <- auto.arima(PG3.tr, lambda = L3)\nsummary(model6)\ntsdiag(model6, gof.lag = 24)\nforecast6 <- forecast(model6, h = 69)\nplot(forecast6, xlim=c(2000,2018), ylim=c(60,140))\nlines(PG2.te, col = \"red\")\naccuracy(forecast6, PG2.te)\n\n# Question 7 - manual selection on reduced data set\nmodel7a <- Arima(PG3.tr, order=c(3,0,3), seasonal=c(3,1,3), include.drift = TRUE)\nsummary(model7a)\n    \nmodel7b <- Arima(PG3.tr, order=c(2,0,2), seasonal=c(2,1,2), include.drift = TRUE)\nsummary(model7b)\ntsdiag(model7b, gof.lag = 24)\nforecast7b <- forecast(model7b, h = 69)\nplot(forecast7b, xlim=c(2000,2018), ylim=c(60,140))\nlines(PG2.te, col = \"red\")\naccuracy(forecast7b, PG2.te)\n    # reduced AICc and BIC \n    # still high out-of-sample bias\n\nmodel7c <- Arima(PG3.tr, order=c(1,0,1), seasonal=c(1,1,1), include.drift = TRUE)\nsummary(model7c)\ntsdiag(model7c, gof.lag = 24)\nforecast7c <- forecast(model7c, h = 69)\nplot(forecast7c, xlim=c(2000,2018), ylim=c(60,140))\nlines(PG2.te, col = \"red\")\naccuracy(forecast7c, PG2.te)\n    # reduced AICc and BIC \n    # still higher out-of-sample bias\n\nmodel7d <- Arima(PG3.tr, order=c(2,0,3), seasonal=c(2,1,2), include.drift = TRUE)\nsummary(model7d)\ntsdiag(model7d, gof.lag = 24)\nforecast7d <- forecast(model7d, h = 69)\nplot(forecast7d, xlim=c(2000,2018), ylim=c(60,140))\nlines(PG2.te, col = \"red\")\naccuracy(forecast7d, PG2.te)\n    # lowest out-of-sample bias!!!\n\n# Question 8 - future forecast\nbest.model <- Arima(PG3.tr, order=c(2,0,3), seasonal=c(2,1,2), include.drift = TRUE)\nsummary(best.model)\ntsdiag(best.model, gof.lag = 24)\nforecast.best <- forecast(best.model, h = 132)\nforecast.best\nplot(forecast.best, xlim=c(2005,2022))\nlines(PG2.te, col = \"red\")\n",
    "created" : 1509748533515.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3798175607",
    "id" : "166C4494",
    "lastKnownWriteTime" : 1509843762,
    "last_content_update" : 1509843762,
    "path" : "C:/Users/jocel/OneDrive/Fall 2017/OM337_scanalytics/HW9/Walker_Jocelyne_HW9/Walker_Jocelyne_HW9.R",
    "project_path" : "Walker_Jocelyne_HW9.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}