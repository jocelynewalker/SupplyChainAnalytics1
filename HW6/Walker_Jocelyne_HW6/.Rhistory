arg3 <- pn
arg4 <- 1
arg5 <- 41
FL <- mL %>%
lapply(mL, FUN = fm(X, arg2, arg3,arg4,arg5), arg2=sn, arg3=pn, arg4=1, arg5=41)
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(mL, fm)
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
m <- mL
FL <- mL %>%
lapply(m, fm)
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(mL, fm, SN = sn, PN = pn, SW = 1, EW = 41)
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
#FL <- mL %>%
FL <- lapply(mL, fm, SN = sn, PN = pn, SW = 1, EW = 41)
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
#FL <- mL %>%
FL <- ml %>% lapply(mL, fm, SN = sn, PN = pn, SW = 1, EW = 41)
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
#FL <- mL %>%
FL <- mL %>% lapply(mL, fm, SN = sn, PN = pn, SW = 1, EW = 41)
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
mL <- list(mSD1,mSD2,mSD3,mSD4,mSD5)
#FL <- mL %>%
FL <- mL %>% lapply(mL, fm, SN = sn, PN = pn, SW = 1, EW = 41)
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
m <- list(mSD1,mSD2,mSD3,mSD4,mSD5)
#FL <- mL %>%
FL <- mL %>% lapply(m, fm, SN = sn, PN = pn, SW = 1, EW = 41)
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
mL <- list(mSD1,mSD2,mSD3,mSD4,mSD5)
#FL <- mL %>%
FL <- mL %>% lapply(mL, fm, SN = sn, PN = pn, SW = 1, EW = 41)
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
mL <- list(mSD1,mSD2,mSD3,mSD4,mSD5)
#FL <- mL %>%
FL <- mL %>%
lapply(FL, fm, SN = sn, PN = pn, SW = 1, EW = 41)
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
mL <- list(mSD1,mSD2,mSD3,mSD4,mSD5)
#FL <- mL %>%
FL <- mL %>%
#lapply(FL, fm, SN = sn, PN = pn, SW = 1, EW = 41)
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
mL <- list(mSD1,mSD2,mSD3,mSD4,mSD5)
#FL <- mL %>%
FL <- mL %>%
lapply(FL, fm, SN = sn, PN = pn, SW = 1, EW = 41)
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
mL <- list(mSD1,mSD2,mSD3,mSD4,mSD5)
#FL <- mL %>%
FL <- mL %>%
lapply(mL, fm, SN = sn, PN = pn, SW = 1, EW = 41)
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
maL <- list(mSD1,mSD2,mSD3,mSD4,mSD5)
#FL <- mL %>%
FL <- maL %>%
lapply(maL, fm, SN = sn, PN = pn, SW = 1, EW = 41)
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
mL <- list(mSD1,mSD2,mSD3,mSD4,mSD5)
#FL <- mL %>%
FL <- mL %>%
lapply(mL, fm, SN = sn, PN = pn, SW = 1, EW = 41)
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply( fm, SN = sn, PN = pn, SW = 1, EW = 41)
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
rownames(FL) <- fmNam
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
return(FL)
}
is.fm(1,"reg")
View(is.fm)
View(is.fm)
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
row.names(FL) <- fmNam
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
FL <- rbind(fmNam, FL)
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
FL <- cbind(fmNam, FL)
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
return(table(FL))
}
is.fm(1,"reg")
return((FL))
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
return((FL))
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
return(table(FL))
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
return((FL))
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm{row.names(mL)<- c("mSD1", "mSD2", "mSD3", "mSD4", "mSD5")}, SN = sn, PN = pn, SW = 1, EW = 40)
return((FL))
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
return((FL))
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40,{row.names(mL)<- c("mSD1", "mSD2", "mSD3", "mSD4", "mSD5")})
return((FL))
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40){row.names(mL)<- c("mSD1", "mSD2", "mSD3", "mSD4", "mSD5")}
return((FL))
}
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
return((FL))
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
typeof(FL)
return((FL))
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
typeof(FL)
return(typeof(FL))
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
return((FL))
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
return(rownames(FL))
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
matrix(FL)
return(matrix(FL))
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
data.frame(FL)
return(data.frame(FL))
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
FK <- data.frame(FL)
row.names(FK) <- c("mSd1","mSd1","mSd1","mSd1","mSd1")
return(FK)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
FK <- data.frame(FL, nrow=5)
row.names(FK) <- c("mSd1","mSd1","mSd1","mSd1","mSd1")
return(FK)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
FK <- data.frame(FL, nrow=5)
#row.names(FK) <- c("mSd1","mSd1","mSd1","mSd1","mSd1")
return(FK)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
FK <- data.frame(FL, ncol =6, nrow=5)
#row.names(FK) <- c("mSd1","mSd1","mSd1","mSd1","mSd1")
return(FK)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
FK <- table(data.frame(FL, ncol =6, nrow=5))
#row.names(FK) <- c("mSd1","mSd1","mSd1","mSd1","mSd1")
return(FK)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
FK <- data.frame(FL, ncol =6, nrow=5)
#row.names(FK) <- c("mSd1","mSd1","mSd1","mSd1","mSd1")
return(FK)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
FK <- data.frame(FL)
#row.names(FK) <- c("mSd1","mSd1","mSd1","mSd1","mSd1")
return(FK)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
FK <- data.frame(FL)
#row.names(FK) <- c("mSd1","mSd1","mSd1","mSd1","mSd1")
return(data.frame(do.call(rbind.data.frame, FL)))
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
FL <- data.frame(do.call(rbind.data.frame, mylist))
#row.names(FK) <- c("mSd1","mSd1","mSd1","mSd1","mSd1")
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
FL <- data.frame(do.call(rbind.data.frame, FL))
#row.names(FK) <- c("mSd1","mSd1","mSd1","mSd1","mSd1")
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
FL <- data.frame(do.call(rbind.data.frame, FL), row.names = c("mSD1", "mSD2", "mSD3", "mSD4", "mSD5"))
#row.names(FK) <- c("mSd1","mSd1","mSd1","mSd1","mSd1")
return(FL)
}
is.fm(1,"reg")
is.fm <- function(sn,pn){
fmNam <- c("ME","MPE","MAE","MAPE","RMSE","MASE")
FL <- mL %>%
lapply(fm, SN = sn, PN = pn, SW = 1, EW = 40)
FL <- data.frame(do.call(rbind.data.frame, FL), row.names = c("mSD1", "mSD2", "mSD3", "mSD4", "mSD5"))
#row.names(FK) <- c("mSd1","mSd1","mSd1","mSd1","mSd1")
return(FL)
}
is.fm(1,"reg")
is.fm(1, "lit")
is.fm(1,"reg")
is.fm(1, "lit")
is.fm(2,"reg")
is.fm(2, "lit")
is.fm(3,"reg")
is.fm(3, "lit")
is.fm(4,"reg")
is.fm(4, "lit")
is.fm(5,"reg")
is.fm(5, "lit")
is.fm(6,"reg")
is.fm(6, "lit")
is.fm(7,"reg")
is.fm(7, "lit")
min(is.fm(1,"reg")[,RMSE])
os.fm <- function(SN,PN,m){
rN <- c(paste("IS",SN,PN,substitute(m)),
paste("OS",SN,PN,substitute(m)))
OSM <- rbind(fm(m,SN,PN,1,40),fm(m,SN,PN,41,52))
rownames(OSM)<- rN
return(OSM)
}
os.fm(2,"lit",mSD1)
is.fm(1,"reg")
is.fm(1, "lit")
is.fm(2,"reg")
is.fm(2, "lit")
is.fm(3,"reg")
is.fm(3, "lit")
is.fm(4,"reg")
is.fm(4, "lit")
is.fm(5,"reg")
is.fm(5, "lit")
is.fm(6,"reg")
is.fm(6, "lit")
is.fm(7,"reg")
is.fm(7, "lit")
os.fm <- function(SN,PN,m){
rN <- c(paste("IS",SN,PN,substitute(m)),
paste("OS",SN,PN,substitute(m)))
OSM <- rbind(fm(m,SN,PN,1,40),fm(m,SN,PN,41,52))
rownames(OSM)<- rN
return(OSM)
}
os.fm(2,"lit",mSD1)
os.fm(6, "reg",mSD5)
os.fm(6, "reg",mSD5)
os.fm(1, "reg",mSD1)
os.fm(1, "lit",mSD5)
os.fm(2, "reg",mSD2)
os.fm(2, "lit",mSD5)
os.fm(3, "reg",mSD1)
os.fm(3, "lit",mSD4)
os.fm(4, "reg",mSD1)
os.fm(4, "lit",mSD5)
os.fm(5, "reg",mSD5)
os.fm(5, "lit",mSD3)
os.fm(6, "reg",mSD5)
os.fm(6, "lit",mSD2)
os.fm(7, "reg",mSD1)
os.fm(7, "lit",mSD2)
os.fm(1, "reg",mSD1)
os.fm(1, "lit",mSD5)
os.fm(2, "reg",mSD2)
os.fm(2, "lit",mSD5)
os.fm(3, "reg",mSD1)
os.fm(3, "lit",mSD4)
os.fm(4, "reg",mSD1)
os.fm(4, "lit",mSD5)
os.fm(5, "reg",mSD5)
os.fm(5, "lit",mSD3)
os.fm(6, "reg",mSD5)
os.fm(6, "lit",mSD2)
os.fm(7, "reg",mSD1)
os.fm(7, "lit",mSD2)
spm.fplot <- function(sn, pname, model){
X <- select.wsp(SD,sn,pname,1,40)
FS <- fitted.sales(X,model)
Week <- FS[,"Week"]
Sales <- FS[,"Sales"]
Fitted <- FS[,"Fitted"]
newX <- select.wsp(SD,sn,pname,41,52)
Fcst <- fitted.sales(newX,model)
FWeek <- Fcst[,"Week"]
N.Sales <- Fcst[,"Sales"]
F.Sales <- Fcst[,"Fitted"]
plot(Week,Sales, type="l", xlim=c(0,52), ylim=c(2000,45000),
main=paste("Store",sn,pname,substitute(model)),
xlab="Weeks", ylab="Sales (oz)")
points(Week,Fitted, col="red", pch=20)
lines(FWeek,N.Sales, col="grey")
points(FWeek,F.Sales, col="blue", pch=20)
}
spm.fplot(7,"lit",mSD2)
spm.fplot(6,"reg",mSD5)
spm.fplot(4,"reg",mSD1)
